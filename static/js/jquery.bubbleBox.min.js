(function(a){a.widget("ui.bubbleBox",{options:{showRemoveButton:!0,list:null,allowDupes:!1,seedData:[],triggerKeyCodes:[13,44,188,59,186]},_create:function(){var b=this;b.input=b.element,b.options.list||(b.options.list="#"+b.input.attr("id")+"_list"),b.list=a(b.options.list).addClass("ui-bubblebox-list"),b.options.showRemoveButton&&b.list.delegate(".ui-bubblebox-removeItem","click",function(c){b.removeItem(a(this.parentNode))}),b.element.bind("blur keydown",function(a){var c=b.input.val();a.type==="blur"||jQuery.inArray(a.which,b.options.triggerKeyCodes)!==-1?b.addItem(c,a)&&(b.input.val(""),a.preventDefault()):c===""&&a.type==="keydown"&&a.which===8&&b.removeItem(b.list.find("li:last-child"))}),a(b.options.seedData).each(function(){b.addItem(this)})},_createBubble:function(b){var c=this.options.showRemoveButton?'<div class="ui-bubblebox-removeItem">x</div>':"";return a('<li class="ui-bubblebox-item"><span>'+b+"</span>"+c+"</li>")},val:function(){var b=[];this.list.children().each(function(){b.push(a(this).find("span").text())});return b},removeItem:function(a,b){a.remove(),this._trigger("remove",b,{value:a.find("span").text(),node:a[0]})},addItem:function(a,b){var c=this,d;if(!c.options.allowDupes&&jQuery.inArray(a,c.val())!==-1)return!1;if(a!==""&&!a.match(/^\s+$/)&&c._trigger("beforeAdd",b,{value:a})!==!1){d=c._createBubble(a),c.list.append(d),c._trigger("afterAdd",b,{value:a,node:d[0]});return d}return!1},_destroy:function(){this.list.empty().removeClass("ui-bubblebox-list"),a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery)